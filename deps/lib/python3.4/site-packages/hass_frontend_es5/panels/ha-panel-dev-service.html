<html><head></head><body><dom-module id="ha-panel-dev-service"><template><style include="ha-style">:host{-ms-user-select:initial;-webkit-user-select:initial;-moz-user-select:initial;}.content{padding:16px;}.ha-form{margin-right:16px;max-width:400px;}.description{margin-top:24px;white-space:pre-wrap;}.header{@apply (--paper-font-title);}.attributes th{text-align:left;}.attributes tr{vertical-align:top;}.attributes tr:nth-child(odd){background-color:var(--table-row-background-color,#eee);}.attributes tr:nth-child(even){background-color:var(--table-row-alternative-background-color,#eee);}.attributes td:nth-child(3){white-space:pre-wrap;word-break:break-word;}pre{margin:0;}h1{white-space:normal;}td{padding:4px;}.error{color:var(--google-red-500);}</style><app-header-layout has-scrolling-region=""><app-header slot="header" fixed=""><app-toolbar><ha-menu-button narrow="[[narrow]]" show-menu="[[showMenu]]"></ha-menu-button><div main-title="">Services</div></app-toolbar></app-header><app-localstorage-document key="panel-dev-service-state-domain-service" data="{{domainService}}"></app-localstorage-document><app-localstorage-document key="[[_computeServicedataKey(domainService)]]" data="{{serviceData}}"></app-localstorage-document><div class="content"><p>The service dev tool allows you to call any available service in Home Assistant.</p><div class="ha-form"><ha-service-picker hass="[[hass]]" value="{{domainService}}"></ha-service-picker><template is="dom-if" if="[[_computeHasEntity(_attributes)]]"><ha-entity-picker hass="[[hass]]" value="[[_computeEntityValue(parsedJSON)]]" on-change="_entityPicked" disabled="[[!validJSON]]" domain-filter="[[_computeEntityDomainFilter(_domain)]]" allow-custom-entity=""></ha-entity-picker></template><paper-textarea always-float-label="" label="Service Data (JSON, optional)" value="{{serviceData}}"></paper-textarea><paper-button on-tap="_callService" raised="" disabled="[[!validJSON]]">Call Service</paper-button><template is="dom-if" if="[[!validJSON]]"><span class="error">Invalid JSON</span></template></div><template is="dom-if" if="[[!domainService]]"><h1>Select a service to see the description</h1></template><template is="dom-if" if="[[domainService]]"><template is="dom-if" if="[[!_description]]"><h1>No description is available</h1></template><template is="dom-if" if="[[_description]]"><h3>[[_description]]</h3><table class="attributes"><tbody><tr><th>Parameter</th><th>Description</th><th>Example</th></tr><template is="dom-if" if="[[!_attributes.length]]"><tr><td colspan="3">This service takes no parameters.</td></tr></template><template is="dom-repeat" items="[[_attributes]]" as="attribute"><tr><td><pre>[[attribute.key]]</pre></td><td>[[attribute.description]]</td><td>[[attribute.example]]</td></tr></template></tbody></table></template></template></div></app-header-layout></template></dom-module><script>function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),ERROR_SENTINEL={},HaPanelDevService=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,Polymer.Element),_createClass(t,[{key:"_domainServiceChanged",value:function(){this.serviceData=""}},{key:"_computeAttributesArray",value:function(e,t,r){var n=e.config.services;if(!(t in n))return[];if(!(r in n[t]))return[];var i=n[t][r].fields;return Object.keys(i).map(function(e){return Object.assign({key:e},i[e])})}},{key:"_computeDescription",value:function(e,t,r){var n=e.config.services;if(t in n&&r in n[t])return n[t][r].description}},{key:"_computeServicedataKey",value:function(e){return"panel-dev-service-state-servicedata."+e}},{key:"_computeDomain",value:function(e){return e.split(".",1)[0]}},{key:"_computeService",value:function(e){return e.split(".",2)[1]||null}},{key:"_computeParsedServiceData",value:function(e){try{return e?JSON.parse(e):{}}catch(e){return ERROR_SENTINEL}}},{key:"_computeValidJSON",value:function(e){return e!==ERROR_SENTINEL}},{key:"_computeHasEntity",value:function(e){return e.some(function(e){return"entity_id"===e.key})}},{key:"_computeEntityValue",value:function(e){return e===ERROR_SENTINEL?"":e.entity_id}},{key:"_computeEntityDomainFilter",value:function(e){return"homeassistant"===e?null:e}},{key:"_callService",value:function(){this.parsedJSON===ERROR_SENTINEL&&alert("Error parsing JSON: "+this.serviceData),this.hass.callService(this._domain,this._service,this.parsedJSON)}},{key:"_entityPicked",value:function(e){this.serviceData=JSON.stringify(Object.assign({},this.parsedJSON,{entity_id:e.target.value}),null,2)}}],[{key:"is",get:function(){return"ha-panel-dev-service"}},{key:"properties",get:function(){return{hass:{type:Object},narrow:{type:Boolean,value:!1},showMenu:{type:Boolean,value:!1},domainService:{type:String,observer:"_domainServiceChanged"},_domain:{type:String,computed:"_computeDomain(domainService)"},_service:{type:String,computed:"_computeService(domainService)"},serviceData:{type:String,value:""},parsedJSON:{type:Object,computed:"_computeParsedServiceData(serviceData)"},validJSON:{type:Boolean,computed:"_computeValidJSON(parsedJSON)"},_attributes:{type:Array,computed:"_computeAttributesArray(hass, _domain, _service)"},_description:{type:String,computed:"_computeDescription(hass, _domain, _service)"}}}}]),t}();customElements.define(HaPanelDevService.is,HaPanelDevService);</script></body></html>