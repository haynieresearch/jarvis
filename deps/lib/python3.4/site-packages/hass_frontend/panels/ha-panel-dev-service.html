<html><head></head><body><dom-module id="ha-panel-dev-service"><template><style include="ha-style">:host{-ms-user-select:initial;-webkit-user-select:initial;-moz-user-select:initial;}.content{padding:16px;}.ha-form{margin-right:16px;max-width:400px;}.description{margin-top:24px;white-space:pre-wrap;}.header{@apply (--paper-font-title);}.attributes th{text-align:left;}.attributes tr{vertical-align:top;}.attributes tr:nth-child(odd){background-color:var(--table-row-background-color,#eee);}.attributes tr:nth-child(even){background-color:var(--table-row-alternative-background-color,#eee);}.attributes td:nth-child(3){white-space:pre-wrap;word-break:break-word;}pre{margin:0;}h1{white-space:normal;}td{padding:4px;}.error{color:var(--google-red-500);}</style><app-header-layout has-scrolling-region=""><app-header slot="header" fixed=""><app-toolbar><ha-menu-button narrow="[[narrow]]" show-menu="[[showMenu]]"></ha-menu-button><div main-title="">Services</div></app-toolbar></app-header><app-localstorage-document key="panel-dev-service-state-domain-service" data="{{domainService}}"></app-localstorage-document><app-localstorage-document key="[[_computeServicedataKey(domainService)]]" data="{{serviceData}}"></app-localstorage-document><div class="content"><p>The service dev tool allows you to call any available service in Home Assistant.</p><div class="ha-form"><ha-service-picker hass="[[hass]]" value="{{domainService}}"></ha-service-picker><template is="dom-if" if="[[_computeHasEntity(_attributes)]]"><ha-entity-picker hass="[[hass]]" value="[[_computeEntityValue(parsedJSON)]]" on-change="_entityPicked" disabled="[[!validJSON]]" domain-filter="[[_computeEntityDomainFilter(_domain)]]" allow-custom-entity=""></ha-entity-picker></template><paper-textarea always-float-label="" label="Service Data (JSON, optional)" value="{{serviceData}}"></paper-textarea><paper-button on-tap="_callService" raised="" disabled="[[!validJSON]]">Call Service</paper-button><template is="dom-if" if="[[!validJSON]]"><span class="error">Invalid JSON</span></template></div><template is="dom-if" if="[[!domainService]]"><h1>Select a service to see the description</h1></template><template is="dom-if" if="[[domainService]]"><template is="dom-if" if="[[!_description]]"><h1>No description is available</h1></template><template is="dom-if" if="[[_description]]"><h3>[[_description]]</h3><table class="attributes"><tbody><tr><th>Parameter</th><th>Description</th><th>Example</th></tr><template is="dom-if" if="[[!_attributes.length]]"><tr><td colspan="3">This service takes no parameters.</td></tr></template><template is="dom-repeat" items="[[_attributes]]" as="attribute"><tr><td><pre>[[attribute.key]]</pre></td><td>[[attribute.description]]</td><td>[[attribute.example]]</td></tr></template></tbody></table></template></template></div></app-header-layout></template></dom-module><script>{const e={};class t extends Polymer.Element{static get is(){return"ha-panel-dev-service"}static get properties(){return{hass:{type:Object},narrow:{type:Boolean,value:!1},showMenu:{type:Boolean,value:!1},domainService:{type:String,observer:"_domainServiceChanged"},_domain:{type:String,computed:"_computeDomain(domainService)"},_service:{type:String,computed:"_computeService(domainService)"},serviceData:{type:String,value:""},parsedJSON:{type:Object,computed:"_computeParsedServiceData(serviceData)"},validJSON:{type:Boolean,computed:"_computeValidJSON(parsedJSON)"},_attributes:{type:Array,computed:"_computeAttributesArray(hass, _domain, _service)"},_description:{type:String,computed:"_computeDescription(hass, _domain, _service)"}}}_domainServiceChanged(){this.serviceData=""}_computeAttributesArray(e,t,i){const r=e.config.services;if(!(t in r))return[];if(!(i in r[t]))return[];const s=r[t][i].fields;return Object.keys(s).map(function(e){return Object.assign({key:e},s[e])})}_computeDescription(e,t,i){const r=e.config.services;if(t in r&&i in r[t])return r[t][i].description}_computeServicedataKey(e){return`panel-dev-service-state-servicedata.${e}`}_computeDomain(e){return e.split(".",1)[0]}_computeService(e){return e.split(".",2)[1]||null}_computeParsedServiceData(t){try{return t?JSON.parse(t):{}}catch(t){return e}}_computeValidJSON(t){return t!==e}_computeHasEntity(e){return e.some(e=>"entity_id"===e.key)}_computeEntityValue(t){return t===e?"":t.entity_id}_computeEntityDomainFilter(e){return"homeassistant"===e?null:e}_callService(){this.parsedJSON===e&&alert(`Error parsing JSON: ${this.serviceData}`),this.hass.callService(this._domain,this._service,this.parsedJSON)}_entityPicked(e){this.serviceData=JSON.stringify(Object.assign({},this.parsedJSON,{entity_id:e.target.value}),null,2)}}customElements.define(t.is,t)}</script></body></html>