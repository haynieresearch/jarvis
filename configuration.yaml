#**********************************************************
#* CATEGORY    CONFIG
#* GROUP       HOME AUTOMATION
#* AUTHOR      LANCE HAYNIE <LANCE@HAYNIEMAIL.COM>
#**********************************************************
#Jarvis Home Automation
#Copyright 2020 Haynie IPHC, LLC
#Developed by Haynie Research & Development, LLC
#Licensed under the Apache License, Version 2.0 (the "License");
#you may not use this file except in compliance with the License.#
#You may obtain a copy of the License at
#http://www.apache.org/licenses/LICENSE-2.0
#Unless required by applicable law or agreed to in writing, software
#distributed under the License is distributed on an "AS IS" BASIS,
#WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#See the License for the specific language governing permissions and
#limitations under the License.

#**********************************************************
#* BASE CONFIG
#**********************************************************
homeassistant:
  auth_providers:
    - type: trusted_networks
      trusted_networks:
        - 127.0.0.1
        - 10.10.0.0/16
      allow_bypass_login: true
    - type: legacy_api_password
      api_password: !secret http_password
    - type: homeassistant
  latitude: !secret latitude_home
  longitude: !secret longitude_home
  elevation: !secret elevation
  name: JARVIS
  temperature_unit: F
  time_zone: America/Denver
  unit_system: imperial
  customize: !include config/customize.yaml

lovelace:
  mode: yaml

ffmpeg:
  ffmpeg_bin: /usr/bin/ffmpeg

stream:

logger:
  default: error
  logs:
    homeassistant.components.device_tracker: error
    homeassistant.components.shell_command: debug

logbook:
  exclude:
    entities:
      - sensor.time
      - sensor.jarvis_greeting
    entity_globs:
      - sensor.weather_*
      - sensor.random_*
recorder:
  db_url: sqlite:///opt/jarvis/database/jarvis.db
updater:
frontend:
  themes: !include_dir_merge_named themes
config:
zeroconf:
discovery:
conversation:
dialogflow:

#**********************************************************
#* ACCOUNTS
#**********************************************************
twilio:
  account_sid: !secret twilio_sid
  auth_token: !secret twilio_token

climate:
  - platform: honeywell
    username: !secret honeywell_user
    password: !secret honeywell_pass
    region: us
    scan_interval: 600
    away_cool_temperature: 26
    away_heat_temperature: 23

#**********************************************************
#* MISC CONFIG
#**********************************************************
notify:
  - name: sms
    platform: twilio_sms
    from_number: !secret twilio_from
  - name: call
    platform: twilio_call
    from_number: !secret twilio_from

shell_command:
  command: "{{cmd}}"
  run_sudo: /usr/bin/sudo "{{cmd}}"
  volume: /usr/bin/amixer -c 0 set Headphone "{{cmd}}"%
  tts: /opt/jarvis/scripts/tts.sh "{{message}}"
  relax: /opt/jarvis/scripts/relax.sh "{{track}}"
  bomb_sound: /usr/bin/aplay /opt/jarvis/sounds/sound_effects/missle_explosion.wav
  alarm_sound: /usr/bin/aplay /opt/jarvis/sounds/sound_effects/alarm.wav
  air_raid_sound: /usr/bin/aplay /opt/jarvis/sounds/asound_effects/ir_raid.wav
  siren: /usr/bin/aplay /opt/jarvis/sounds/sound_effects/siren.wav
  bullmastiff: /usr/bin/aplay /opt/jarvis/sounds/sound_effects/bullmastiff.wav
  german_shephard: /usr/bin/aplay /opt/jarvis/sounds/sound_effects/german-shephard.wav
  restart_system: /opt/jarvis/scripts/restart_system.sh
  restart_jarvis_base: /opt/jarvis/scripts/restart_jarvis_base.sh
  restart_jarvis_stt: /opt/jarvis/scripts/restart_jarvis_stt.sh
  restart_jarvis_tts: /opt/jarvis/scripts/restart_jarvis_tts.sh
  naturesounds: /usr/bin/omxplayer --vol 750 /opt/jarvis/sounds/morninglight.mp3
  whitenoise: /usr/bin/omxplayer --vol 500 /opt/jarvis/sounds/whitenoise.mp3
  killnaturesounds: kill $(ps aux | grep '/usr/bin/omxplayer.bin --vol 750 /opt/jarvis/sounds/morninglight.mp3' | awk '{print $2}')
  killwhitenoise: kill $(ps aux | grep '/usr/bin/omxplayer.bin --vol 500 /opt/jarvis/sounds/whitenoise.mp3' | awk '{print $2}')
  alert: /usr/bin/omxplayer --vol 25 /opt/jarvis/sounds/tones/notification.mp3
  winxpstart: /usr/bin/omxplayer --vol 25 /opt/jarvis/sounds/tones/winxp_startup.mp3
  winxpstop: /usr/bin/omxplayer --vol 25 /opt/jarvis/sounds/tones/winxp_shutdown.mp3
  joke: /opt/jarvis/scripts/joke.sh

#Alarm Panel
alarm_control_panel:
  - platform: manual
    name: Home Alarm
    code: !secret alarm_code
    arming_time: 30
    delay_time: 20
    trigger_time: 4
    disarmed:
      trigger_time: 0
    armed_home:
      arming_time: 0
      delay_time: 0

#**********************************************************
#* INCLUDES
#**********************************************************
automation: !include config/automations.yaml
intent_script: !include config/intents.yaml
camera: !include config/cameras.yaml
light: !include config/lights.yaml
sensor: !include config/sensors.yaml
switch: !include config/switches.yaml
binary_sensor: !include config/binary_sensors.yaml
scene: !include config/scenes.yaml
input_select: !include config/input_select.yaml
input_boolean: !include config/input_boolean.yaml
input_number: !include config/input_number.yaml
script: !include config/scripts.yaml
